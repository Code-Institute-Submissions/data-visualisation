"use strict";var gainOrLossChart=dc.pieChart("#gain-loss-chart"),fluctuationChart=dc.barChart("#fluctuation-chart"),dayOfWeekChart=dc.rowChart("#day-of-week-chart"),moveChart=dc.lineChart("#monthly-move-chart"),volumeChart=dc.barChart("#monthly-volume-chart"),monthlyBubbleChart=dc.bubbleChart("#yearly-bubble-chart"),width=340,height=300;d3.csv("https://www.quandl.com/api/v3/datasets/BCHARTS/COINBASEEUR.csv?api_key=fzanZC3297Jsid-E8vCF").then(function(e){var n=d3.timeFormat("%Y-%m-%d"),t=d3.timeParse("%Y-%m-%d"),a=d3.format(".2f");e.forEach(function(e){e.dd=t(e.Date),e.month=d3.timeMonth(e.dd),e.Close=+e.Close,e.Open=+e.Open});var r=d3.min(e,function(e){return e.Date}),i=d3.max(e,function(e){return e.Date}),o=crossfilter(e),u=o.groupAll(),d=o.dimension(function(e){return e.dd.getMonth()+1==1?"Jan ":e.dd.getMonth()+1==2?"Feb":e.dd.getMonth()+1==3?"Mar":e.dd.getMonth()+1==4?"Apr":e.dd.getMonth()+1==5?"May":e.dd.getMonth()+1==6?"Jun":e.dd.getMonth()+1==7?"Jul":e.dd.getMonth()+1==8?"Aug":e.dd.getMonth()+1==9?"Sep":e.dd.getMonth()+1==10?"Oct":e.dd.getMonth()+1==11?"Nov":e.dd.getMonth()+1==12?"Dece":void 0}),s=d.group().reduce(function(e,n){return++e.count,e.absGain+=n.Close-n.Open,e.fluctuation+=Math.abs(n.Close-n.Open),e.sumIndex+=(n.Open+n.Close)/2,e.avgIndex=e.sumIndex/e.count,e.percentageGain=e.avgIndex?e.absGain/e.avgIndex*100:0,e.fluctuationPercentage=e.avgIndex?e.fluctuation/e.avgIndex*100:0,e},function(e,n){return--e.count,e.absGain-=n.Close-n.Open,e.fluctuation-=Math.abs(n.Close-n.Open),e.sumIndex-=(n.Open+n.Close)/2,e.avgIndex=e.count?e.sumIndex/e.count:0,e.percentageGain=e.avgIndex?e.absGain/e.avgIndex*100:0,e.fluctuationPercentage=e.avgIndex?e.fluctuation/e.avgIndex*100:0,e},function(){return{count:0,absGain:0,fluctuation:0,fluctuationPercentage:0,sumIndex:0,avgIndex:0,percentageGain:0}}),l=(o.dimension(function(e){return e.dd}),o.dimension(function(e){return e.month})),c=l.group().reduceSum(function(e){return Math.abs(e.Close-e.Open)}),h=l.group().reduceSum(function(e){return e["Volume (Currency)"]/1e8}),g=l.group().reduce(function(e,n){return++e.days,e.total+=(n.Open+n.Close)/2,e.avg=Math.round(e.total/e.days),e},function(e,n){return--e.days,e.total-=(n.Open+n.Close)/2,e.avg=e.days?Math.round(e.total/e.days):0,e},function(){return{days:0,total:0,avg:0}}),m=o.dimension(function(e){return e.Open>e.Close?"Loss":"Gain"}),f=m.group(),v=o.dimension(function(e){return Math.round((e.Close-e.Open)/e.Open*100)}),p=v.group(),C=o.dimension(function(e){var n=e.dd.getDay();return n+"."+["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][n]}),b=C.group();monthlyBubbleChart.width(width).height(height).transitionDuration(1500).margins({top:10,right:50,bottom:55,left:40}).dimension(d).group(s).colors(d3.schemeRdYlGn[9]).colorDomain([-500,500]).colorAccessor(function(e){return e.value.absGain}).keyAccessor(function(e){return e.value.absGain}).valueAccessor(function(e){return e.value.percentageGain}).radiusValueAccessor(function(e){return e.value.fluctuationPercentage}).maxBubbleRelativeSize(.3).x(d3.scaleLinear().domain([-2500,2500])).y(d3.scaleLinear().domain([-100,100])).r(d3.scaleLinear().domain([0,4e3])).elasticY(!0).elasticX(!0).yAxisPadding(100).xAxisPadding(500).renderHorizontalGridLines(!0).renderVerticalGridLines(!0).xAxisLabel("Crytpo Gain $").yAxisLabel("Crypto Gain %").renderLabel(!0).label(function(e){return e.key}).renderTitle(!0).title(function(e){return[e.key,"Index Gain: "+a(e.value.absGain),"Index Gain in Percentage: "+a(e.value.percentageGain)+"%","Fluctuation / Index Ratio: "+a(e.value.fluctuationPercentage)+"%"].join("\n")}).yAxis().tickFormat(function(e){return e+"%"}),gainOrLossChart.width(width).height(height).radius(80).dimension(m).group(f).label(function(e){if(gainOrLossChart.hasFilter()&&!gainOrLossChart.hasFilter(e.key))return e.key+"(0%)";var n=e.key;return u.value()&&(n+="("+Math.floor(e.value/u.value()*100)+"%)"),n}),dayOfWeekChart.width(width).height(height).margins({top:20,left:10,right:10,bottom:20}).group(b).dimension(C).ordinalColors(["#3182bd","#6baed6","#9ecae1","#c6dbef","#dadaeb"]).label(function(e){return e.key.split(".")[1]}).title(function(e){return e.value}).elasticX(!0).xAxis().ticks(4),fluctuationChart.width(width).height(height).margins({top:10,right:50,bottom:30,left:40}).dimension(v).group(p).elasticY(!0).centerBar(!0).gap(1).round(dc.round.floor).alwaysUseRounding(!0).x(d3.scaleLinear().domain([-25,25])).renderHorizontalGridLines(!0).filterPrinter(function(e){var n=e[0],t="";return t+=a(n[0])+"% -> "+a(n[1])+"%"}),fluctuationChart.xAxis().tickFormat(function(e){return e+"%"}),fluctuationChart.yAxis().ticks(5),moveChart.renderArea(!0).width(width).height(150).transitionDuration(1e3).margins({top:30,right:50,bottom:55,left:52}).dimension(l).mouseZoomable(!0).rangeChart(volumeChart).x(d3.scaleTime().domain([new Date(r),new Date(i)])).round(d3.timeMonth.round).xUnits(d3.timeMonths).elasticY(!0).renderHorizontalGridLines(!0).legend(dc.legend().x(800).y(10).itemHeight(13).gap(5)).brushOn(!1).group(g,"Monthly Index Average").valueAccessor(function(e){return e.value.avg}).stack(c,"Monthly Index Move",function(e){return e.value}).title(function(e){var t=e.value.avg?e.value.avg:e.value;return isNaN(t)&&(t=0),n(e.key)+"\n"+a(t)}),volumeChart.width(width).height(150).margins({top:0,right:50,bottom:55,left:40}).dimension(l).group(h).centerBar(!0).gap(1).x(d3.scaleTime().domain([new Date(r),new Date(i)])).round(d3.timeMonth.round).alwaysUseRounding(!0).xUnits(d3.timeMonths).yAxisLabel("Billions $"),dc.renderAll()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRjLmpzIl0sIm5hbWVzIjpbImdhaW5Pckxvc3NDaGFydCIsImRjIiwicGllQ2hhcnQiLCJmbHVjdHVhdGlvbkNoYXJ0IiwiYmFyQ2hhcnQiLCJsaW5lQ2hhcnQiLCJkYXlPZldlZWtDaGFydCIsIm1vdmVDaGFydCIsImJ1YmJsZUNoYXJ0IiwibW9udGhseUJ1YmJsZUNoYXJ0Iiwid2lkdGgiLCJkMyIsImNzdiIsInRoZW4iLCJkYXRhIiwiZGF0ZUZvcm1hdCIsInRpbWVGb3JtYXQiLCJkYXRlRm9ybWF0UGFyc2VyIiwidGltZVBhcnNlIiwibnVtYmVyRm9ybWF0IiwiZm9ybWF0IiwiZCIsImRkIiwibW9udGgiLCJEYXRlIiwidGltZU1vbnRoIiwiQ2xvc2UiLCJPcGVuIiwibWluRGF0ZSIsIm1pbiIsIm1heERhdGUiLCJhbGwiLCJuZHgiLCJkaW1lbnNpb24iLCJncm91cEFsbCIsImdldE1vbnRoIiwibW9udGhseURpbWVuc2lvbiIsIm1vbnRobHlQZXJmb3JtYW5jZUdyb3VwIiwiZ3JvdXAiLCJyZWR1Y2UiLCJwIiwicGVyY2VudGFnZUdhaW4iLCJjb3VudCIsImFic0dhaW4iLCJ2IiwiZmx1Y3R1YXRpb24iLCJNYXRoIiwiYWJzIiwic3VtSW5kZXgiLCJhdmdJbmRleCIsImZsdWN0dWF0aW9uUGVyY2VudGFnZSIsIm1vdmVNb250aHMiLCJtb250aGx5TW92ZUdyb3VwIiwicmVkdWNlU3VtIiwidm9sdW1lQnlNb250aEdyb3VwIiwidG90YWwiLCJkYXlzIiwiYXZnIiwicm91bmQiLCJnYWluT3JMb3NzIiwiZmx1Y3R1YXRpb25Hcm91cCIsImRheU9mV2VlayIsImRheU9mV2Vla0dyb3VwIiwiZGF5IiwicmlnaHQiLCJsZWZ0IiwiaGVpZ2h0IiwidHJhbnNpdGlvbkR1cmF0aW9uIiwidG9wIiwiY29sb3JzIiwic2NoZW1lUmRZbEduIiwia2V5QWNjZXNzb3IiLCJjb2xvckRvbWFpbiIsImNvbG9yQWNjZXNzb3IiLCJtYXhCdWJibGVSZWxhdGl2ZVNpemUiLCJ5QXhpc1BhZGRpbmciLCJ4QXhpc1BhZGRpbmciLCJ4QXhpc0xhYmVsIiwieUF4aXNMYWJlbCIsInZhbHVlIiwicmFkaXVzVmFsdWVBY2Nlc3NvciIsIngiLCJzY2FsZUxpbmVhciIsImRvbWFpbiIsInkiLCJyIiwiZWxhc3RpY1kiLCJsYWJlbCIsImtleSIsInJlbmRlckxhYmVsIiwicmVuZGVyVGl0bGUiLCJvcmRpbmFsQ29sb3JzIiwieUF4aXMiLCJ0aWNrRm9ybWF0IiwiYm90dG9tIiwiZ2FwIiwiZmlsdGVyUHJpbnRlciIsImhhc0ZpbHRlciIsImZsb29yIiwicmVuZGVyQXJlYSIsInJhbmdlQ2hhcnQiLCJ2b2x1bWVDaGFydCIsInNwbGl0IiwiaXRlbUhlaWdodCIsImluZGV4QXZnQnlNb250aEdyb3VwIiwiZWxhc3RpY1giLCJzdGFjayIsInRpY2tzIiwibWFyZ2lucyIsInJlbmRlckFsbCIsImFsd2F5c1VzZVJvdW5kaW5nIiwicmVuZGVySG9yaXpvbnRhbEdyaWRMaW5lcyIsImZpbHRlcnMiLCJmaWx0ZXIiLCJzIiwieEF4aXMiLCJtb3VzZVpvb21hYmxlIiwic2NhbGVUaW1lIiwieFVuaXRzIiwidGltZU1vbnRocyIsImxlZ2VuZCIsImJydXNoT24iLCJ2YWx1ZUFjY2Vzc29yIiwidGl0bGUiLCJpc05hTiIsImNlbnRlckJhciJdLCJtYXBwaW5ncyI6ImFBQUEsSUFBTUEsZ0JBQWtCQyxHQUFHQyxTQUFTLG9CQUM5QkMsaUJBQW1CRixHQUFHRyxTQUFTLHNCQUQvQkosZUFBa0JDLEdBQUdDLFNBQVMsc0JBQzlCQyxVQUFBQSxHQUFnQkUsVUFBTUQsdUJBQ3RCRSxZQUFjTCxHQUFLRyxTQUFGLHlCQUNqQkcsbUJBQWVGLEdBQVVHLFlBQUEsd0JBRXpCQyxNQUFBQSxJQUVBQyxPQUFOLElBR0FDLEdBQUdDLElBQUksK0ZBQStGQyxLQUFLLFNBQUFDLEdBRXpHLElBQ0lDLEVBQWFKLEdBQUdLLFdBRE0sWUFFdEJDLEVBQW1CTixHQUFHTyxVQUZBLFlBR3RCQyxFQUFlUixHQUFHUyxPQUFP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aWVDaGFydCgnI2dhaW4tbG9zcy1jaGFydCcpO1xuY29uc3QgZmx1Y3R1YXRpb25DaGFydCA9IGRjLmJhckNoYXJ0KCcjZmx1Y3R1YXRpb24tY2hhcnQnKTtcbmNvbnN0IGRheU9mV2Vla0NoYXJ0ID0gZGMucm93Q2hhcnQoJyNkYXktb2Ytd2Vlay1jaGFydCcpO1xuY29uc3QgbW92ZUNoYXJ0ID0gZGMubGluZUNoYXJ0KCcjbW9udGhseS1tb3ZlLWNoYXJ0Jyk7XG5jb25zdCB2b2x1bWVDaGFydCA9IGRjLmJhckNoYXJ0KCcjbW9udGhseS12b2x1bWUtY2hhcnQnKTtcbmNvbnN0IG1vbnRobHlCdWJibGVDaGFydCA9IGRjLmJ1YmJsZUNoYXJ0KCcjeWVhcmx5LWJ1YmJsZS1jaGFydCcpO1xuXG5jb25zdCB3aWR0aCA9IDM0MDtcbmNvbnN0IGhlaWdodCA9IDMwMDtcblxuZDMuY3N2KCdodHRwczovL3d3dy5xdWFuZGwuY29tL2FwaS92My9kYXRhc2V0cy9CQ0hBUlRTL0NPSU5CQVNFRVVSLmNzdj9hcGlfa2V5PWZ6YW5aQzMyOTdKc2lkLUU4dkNGJykudGhlbigoZGF0YSkgPT4ge1xuICAvLyBGb3JtYXQgdGhlIGRhdGFcbiAgbGV0IGRhdGVGb3JtYXRTcGVjaWZpZXIgPSAnJVktJW0tJWQnO1xuICBsZXQgZGF0ZUZvcm1hdCA9IGQzLnRpbWVGb3JtYXQoZGF0ZUZvcm1hdFNwZWNpZmllcik7XG4gIGxldCBkYXRlRm9ybWF0UGFyc2VyID0gZDMudGltZVBhcnNlKGRhdGVGb3JtYXRTcGVjaWZpZXIpO1xuICBsZXQgbnVtYmVyRm9ybWF0ID0gZDMuZm9ybWF0KCcuMmYnKTtcblxuICBkYXRhLmZvckVhY2goKGQpID0+IHtcbiAgICAgICAgZC5kZCA9IGRhdGVGb3JtYXRQYXJzZXIoZC5EYXRlKTtcbiAgICAgICAgZC5tb250aCA9IGQzLnRpbWVNb250aChkLmRkKTsgLy8gcHJlLWNhbGN1bGF0ZSBtb250aFxuICAgICAgICBkLkNsb3NlID0gK2QuQ2xvc2U7IC8vIGNoYW5nZSB0byBudW1iZXJcbiAgICAgICAgZC5PcGVuID0gK2QuT3BlbjtcbiAgICB9KTtcbiAgLy8gRmluZCBmaXJzdCBhbmQgbGFzdCBkYXRlXG4gIGNvbnN0IG1pbkRhdGUgPSBkMy5taW4oZGF0YSwgZCA9PiBkLkRhdGUpO1xuICBjb25zdCBtYXhEYXRlID0gZDMubWF4KGRhdGEsIGQgPT4gZC5EYXRlKTtcblxuICAvLyBDcmVhdGUgQ3Jvc3NmaWx0ZXIgRGltZW5zaW9ucyBhbmQgR3JvdXBzXG4gIGxldCBuZHggPSBjcm9zc2ZpbHRlcihkYXRhKTtcbiAgbGV0IGFsbCA9IG5keC5ncm91cEFsbCgpO1xuXG4gIC8vIERpbWVuc2lvbiBieSBtb250aFxuICBsZXQgbW9udGhseURpbWVuc2lvbiA9IG5keC5kaW1lbnNpb24oKGQpID0+IHtcbiAgICAgICAgIGlmIChkLmRkLmdldE1vbnRoKCkrMT09MSkgcmV0dXJuICBcIkphbiBcIlxuICAgICAgICAgaWYgKGQuZGQuZ2V0TW9udGgoKSsxPT0yKSByZXR1cm4gIFwiRmViXCJcbiAgICAgICAgIGlmIChkLmRkLmdldE1vbnRoKCkrMT09MykgcmV0dXJuICBcIk1hclwiXG4gICAgICAgICBpZiAoZC5kZC5nZXRNb250aCgpKzE9PTQpIHJldHVybiAgXCJBcHJcIlxuICAgICAgICAgaWYgKGQuZGQuZ2V0TW9udGgoKSsxPT01KSByZXR1cm4gIFwiTWF5XCJcbiAgICAgICAgIGlmIChkLmRkLmdldE1vbnRoKCkrMT09NikgcmV0dXJuICBcIkp1blwiXG4gICAgICAgICBpZiAoZC5kZC5nZXRNb250aCgpKzE9PTcpIHJldHVybiAgXCJKdWxcIlxuICAgICAgICAgaWYgKGQuZGQuZ2V0TW9udGgoKSsxPT04KSByZXR1cm4gIFwiQXVnXCJcbiAgICAgICAgIGlmIChkLmRkLmdldE1vbnRoKCkrMT09OSkgcmV0dXJuICBcIlNlcFwiXG4gICAgICAgICBpZiAoZC5kZC5nZXRNb250aCgpKzE9PTEwKSByZXR1cm4gIFwiT2N0XCJcbiAgICAgICAgIGlmIChkLmRkLmdldE1vbnRoKCkrMT09MTEpIHJldHVybiAgXCJOb3ZcIlxuICAgICAgICAgaWYgKGQuZGQuZ2V0TW9udGgoKSsxPT0xMikgcmV0dXJuICBcIkRlY2VcIlxuICAgIH0pO1xuXG4gIC8vIE1haW50YWluIHJ1bm5pbmcgdGFsbGllcyBieSBtb250aCBhcyBmaWx0ZXJzIGFyZSBhcHBsaWVkIG9yIHJlbW92ZWRcbiAgbGV0IG1vbnRobHlQZXJmb3JtYW5jZUdyb3VwID0gbW9udGhseURpbWVuc2lvbi5ncm91cCgpLnJlZHVjZShcbiAgICAvKiBjYWxsYmFjayBmb3Igd2hlbiBkYXRhIGlzIGFkZGVkIHRvIHRoZSBjdXJyZW50IGZpbHRlciByZXN1bHRzICovXG4gICAgKHAsIHYpID0+IHtcbiAgICAgICAgICAgICsrcC5jb3VudDtcbiAgICAgICAgICAgIHAuYWJzR2FpbiArPSB2LkNsb3NlIC0gdi5PcGVuO1xuICAgICAgICAgICAgcC5mbHVjdHVhdGlvbiArPSBNYXRoLmFicyh2LkNsb3NlIC0gdi5PcGVuKTtcbiAgICAgICAgICAgIHAuc3VtSW5kZXggKz0gKHYuT3BlbiArIHYuQ2xvc2UpIC8gMjtcbiAgICAgICAgICAgIHAuYXZnSW5kZXggPSBwLnN1bUluZGV4IC8gcC5jb3VudDtcbiAgICAgICAgICAgIHAucGVyY2VudGFnZUdhaW4gPSBwLmF2Z0luZGV4ID8gKHAuYWJzR2FpbiAvIHAuYXZnSW5kZXgpICogMTAwIDogMDtcbiAgICAgICAgICAgIHAuZmx1Y3R1YXRpb25QZXJjZW50YWdlID0gcC5hdmdJbmRleCA/IChwLmZsdWN0dWF0aW9uIC8gcC5hdmdJbmRleCkgKiAxMDAgOiAwO1xuICAgICAgICAgICAgcmV0dXJuIHA7XG4gICAgICAgIH0sXG4gICAgLyogY2FsbGJhY2sgZm9yIHdoZW4gZGF0YSBpcyByZW1vdmVkIGZyb20gdGhlIGN1cnJlbnQgZmlsdGVyIHJlc3VsdHMgKi9cbiAgICAocCwgdikgPT4ge1xuICAgICAgICAgICAgLS1wLmNvdW50O1xuICAgICAgICAgICAgcC5hYnNHYWluIC09IHYuQ2xvc2UgLSB2Lk9wZW47XG4gICAgICAgICAgICBwLmZsdWN0dWF0aW9uIC09IE1hdGguYWJzKHYuQ2xvc2UgLSB2Lk9wZW4pO1xuICAgICAgICAgICAgcC5zdW1JbmRleCAtPSAodi5PcGVuICsgdi5DbG9zZSkgLyAyO1xuICAgICAgICAgICAgcC5hdmdJbmRleCA9IHAuY291bnQgPyBwLnN1bUluZGV4IC8gcC5jb3VudCA6IDA7XG4gICAgICAgICAgICBwLnBlcmNlbnRhZ2VHYWluID0gcC5hdmdJbmRleCA/IChwLmFic0dhaW4gLyBwLmF2Z0luZGV4KSAqIDEwMCA6IDA7XG4gICAgICAgICAgICBwLmZsdWN0dWF0aW9uUGVyY2VudGFnZSA9IHAuYXZnSW5kZXggPyAocC5mbHVjdHVhdGlvbiAvIHAuYXZnSW5kZXgpICogMTAwIDogMDtcbiAgICAgICAgICAgIHJldHVybiBwO1xuICAgICAgICB9LFxuICAgIC8qIGluaXRpYWxpemUgcCAqL1xuICAgICgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgY291bnQ6IDAsXG4gICAgICAgICAgICAgICAgYWJzR2FpbjogMCxcbiAgICAgICAgICAgICAgICBmbHVjdHVhdGlvbjogMCxcbiAgICAgICAgICAgICAgICBmbHVjdHVhdGlvblBlcmNlbnRhZ2U6IDAsXG4gICAgICAgICAgICAgICAgc3VtSW5kZXg6IDAsXG4gICAgICAgICAgICAgICAgYXZnSW5kZXg6IDAsXG4gICAgICAgICAgICAgICAgcGVyY2VudGFnZUdhaW46IDBcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG4gICk7XG5cbiAgLy8gRGltZW5zaW9uIGJ5IGZ1bGwgZGF0ZVxuICBsZXQgZGF0ZURpbWVuc2lvbiA9IG5keC5kaW1lbnNpb24oKGQpID0+IHtcbiAgICAgICAgcmV0dXJuIGQuZGQ7XG4gICAgfSk7XG5cbiAgLy8gRGltZW5zaW9uIGJ5IG1vbnRoXG4gIGxldCBtb3ZlTW9udGhzID0gbmR4LmRpbWVuc2lvbigoZCkgPT4ge1xuICAgICAgICByZXR1cm4gZC5tb250aDtcbiAgICB9KTtcbiAgICAvLyBHcm91cCBieSB0b3RhbCBtb3ZlbWVudCB3aXRoaW4gbW9udGhcbiAgbGV0IG1vbnRobHlNb3ZlR3JvdXAgPSBtb3ZlTW9udGhzLmdyb3VwKCkucmVkdWNlU3VtKChkKSA9PiB7XG4gICAgICAgIHJldHVybiBNYXRoLmFicyhkLkNsb3NlIC0gZC5PcGVuKTtcbiAgICB9KTtcbiAgICAvLyBHcm91cCBieSB0b3RhbCB2b2x1bWUgd2l0aGluIG1vdmUsIGFuZCBzY2FsZSBkb3duIHJlc3VsdFxuICBsZXQgdm9sdW1lQnlNb250aEdyb3VwID0gbW92ZU1vbnRocy5ncm91cCgpLnJlZHVjZVN1bSgoZCkgPT4ge1xuICAgICAgICByZXR1cm4gZFsnVm9sdW1lIChDdXJyZW5jeSknXS8xMDAwMDAwMDBcbiAgICB9KTtcbiAgbGV0IGluZGV4QXZnQnlNb250aEdyb3VwID0gbW92ZU1vbnRocy5ncm91cCgpLnJlZHVjZShcbiAgICAocCwgdikgPT4ge1xuICAgICAgICAgICAgKytwLmRheXM7XG4gICAgICAgICAgICBwLnRvdGFsICs9ICh2Lk9wZW4gKyB2LkNsb3NlKSAvIDI7XG4gICAgICAgICAgICBwLmF2ZyA9IE1hdGgucm91bmQocC50b3RhbCAvIHAuZGF5cyk7XG4gICAgICAgICAgICByZXR1cm4gcDtcbiAgICAgICAgfSxcbiAgICAocCwgdikgPT4ge1xuICAgICAgICAgICAgLS1wLmRheXM7XG4gICAgICAgICAgICBwLnRvdGFsIC09ICh2Lk9wZW4gKyB2LkNsb3NlKSAvIDI7XG4gICAgICAgICAgICBwLmF2ZyA9IHAuZGF5cyA/IE1hdGgucm91bmQocC50b3RhbCAvIHAuZGF5cykgOiAwO1xuICAgICAgICAgICAgcmV0dXJuIHA7XG4gICAgICAgIH0sXG4gICAgKCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHtkYXlzOiAwLCB0b3RhbDogMCwgYXZnOiAwfTtcbiAgICAgICAgfSxcbiAgKTtcblxuICAvLyBDcmVhdGUgY2F0ZWdvcmljYWwgZGltZW5zaW9uXG4gIGxldCBnYWluT3JMb3NzID0gbmR4LmRpbWVuc2lvbigoZCkgPT4ge1xuICAgICAgICByZXR1cm4gZC5PcGVuID4gZC5DbG9zZSA/ICdMb3NzJyA6ICdHYWluJztcbiAgICB9KTtcbiAgICAvLyBQcm9kdWNlIGNvdW50cyByZWNvcmRzIGluIHRoZSBkaW1lbnNpb25cbiAgbGV0IGdhaW5Pckxvc3NHcm91cCA9IGdhaW5Pckxvc3MuZ3JvdXAoKTtcblxuICAvLyBEZXRlcm1pbmUgYSBoaXN0b2dyYW0gb2YgcGVyY2VudCBjaGFuZ2VzXG4gIGxldCBmbHVjdHVhdGlvbiA9IG5keC5kaW1lbnNpb24oKGQpID0+IHtcbiAgICAgICAgcmV0dXJuIE1hdGgucm91bmQoKGQuQ2xvc2UgLSBkLk9wZW4pIC8gZC5PcGVuICogMTAwKTtcbiAgICB9KTtcbiAgbGV0IGZsdWN0dWF0aW9uR3JvdXAgPSBmbHVjdHVhdGlvbi5ncm91cCgpO1xuXG4gIC8vIENvdW50cyBwZXIgd2Vla2RheVxuICBsZXQgZGF5T2ZXZWVrID0gbmR4LmRpbWVuc2lvbigoZCkgPT4ge1xuICAgICAgICB2YXIgZGF5ID0gZC5kZC5nZXREYXkoKTtcbiAgICAgICAgdmFyIG5hbWUgPSBbJ1N1bicsICdNb24nLCAnVHVlJywgJ1dlZCcsICdUaHUnLCAnRnJpJywgJ1NhdCddO1xuICAgICAgICByZXR1cm4gZGF5ICsgJy4nICsgbmFtZVtkYXldO1xuICAgIH0pO1xuICBsZXQgZGF5T2ZXZWVrR3JvdXAgPSBkYXlPZldlZWsuZ3JvdXAoKTtcblxuICBtb250aGx5QnViYmxlQ2hhcnQgLyogZGMuYnViYmxlQ2hhcnQoJyN5ZWFybHktYnViYmxlLWNoYXJ0JywgJ2NoYXJ0R3JvdXAnKSAqL1xuICAvLyAoX29wdGlvbmFsXykgZGVmaW5lIGNoYXJ0IHdpZHRoLCBgZGVmYXVsdCA9IDIwMGBcbiAgICAud2lkdGgod2lkdGgpXG4gIC8vIChfb3B0aW9uYWxfKSBkZWZpbmUgY2hhcnQgaGVpZ2h0LCBgZGVmYXVsdCA9IDIwMGBcbiAgICAuaGVpZ2h0KGhlaWdodClcbiAgLy8gKF9vcHRpb25hbF8pIGRlZmluZSBjaGFydCB0cmFuc2l0aW9uIGR1cmF0aW9uLCBgZGVmYXVsdCA9IDc1MGBcbiAgICAudHJhbnNpdGlvbkR1cmF0aW9uKDE1MDApXG4gICAgLm1hcmdpbnMoeyBcbnRvcDogMTAsIHJpZ2h0OiA1MCwgYm90dG9tOiA1NSwgbGVmdDogNDBcbiB9KVxuICAgIC5kaW1lbnNpb24obW9udGhseURpbWVuc2lvbilcbiAgLy8gVGhlIGJ1YmJsZSBjaGFydCBleHBlY3RzIHRoZSBncm91cHMgYXJlIHJlZHVjZWQgdG8gbXVsdGlwbGUgdmFsdWVzIHdoaWNoIGFyZSB1c2VkXG4gIC8vIHRvIGdlbmVyYXRlIHgsIHksIGFuZCByYWRpdXMgZm9yIGVhY2gga2V5IChidWJibGUpIGluIHRoZSBncm91cFxuICAgIC5ncm91cChtb250aGx5UGVyZm9ybWFuY2VHcm91cClcbiAgLy8gKF9vcHRpb25hbF8pIGRlZmluZSBjb2xvciBmdW5jdGlvbiBvciBhcnJheSBmb3IgYnViYmxlczogW0NvbG9yQnJld2VyXShodHRwOi8vY29sb3JicmV3ZXIyLm9yZy8pXG4gICAgLmNvbG9ycyhkMy5zY2hlbWVSZFlsR25bOV0pXG4gIC8vIChvcHRpb25hbCkgZGVmaW5lIGNvbG9yIGRvbWFpbiB0byBtYXRjaCB5b3VyIGRhdGEgZG9tYWluIGlmIHlvdSB3YW50IHRvIGJpbmQgZGF0YSBvciBjb2xvclxuICAgIC5jb2xvckRvbWFpbihbLTUwMCwgNTAwXSlcbiAgICAvLyAjIyMjIyBBY2Nlc3NvcnNcblxuICAvLyBBY2Nlc3NvciBmdW5jdGlvbnMgYXJlIGFwcGxpZWQgdG8gZWFjaCB2YWx1ZSByZXR1cm5lZCBieSB0aGUgZ3JvdXBpbmdcblxuICAvLyBgLmNvbG9yQWNjZXNzb3JgIC0gdGhlIHJldHVybmVkIHZhbHVlIHdpbGwgYmUgcGFzc2VkIHRvIHRoZSBgLmNvbG9ycygpYCBzY2FsZSB0byBkZXRlcm1pbmUgYSBmaWxsIGNvbG9yXG4gICAgLmNvbG9yQWNjZXNzb3IoKGQpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBkLnZhbHVlLmFic0dhaW47XG4gICAgICAgIH0pXG4gIC8vIGAua2V5QWNjZXNzb3JgIC0gdGhlIGBYYCB2YWx1ZSB3aWxsIGJlIHBhc3NlZCB0byB0aGUgYC54KClgIHNjYWxlIHRvIGRldGVybWluZSBwaXhlbCBsb2NhdGlvblxuICAgIC5rZXlBY2Nlc3NvcigocCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHAudmFsdWUuYWJzR2FpbjtcbiAgICAgICAgfSlcbiAgLy8gYC52YWx1ZUFjY2Vzc29yYCAtIHRoZSBgWWAgdmFsdWUgd2lsbCBiZSBwYXNzZWQgdG8gdGhlIGAueSgpYCBzY2FsZSB0byBkZXRlcm1pbmUgcGl4ZWwgbG9jYXRpb25cbiAgICAudmFsdWVBY2Nlc3NvcigocCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHAudmFsdWUucGVyY2VudGFnZUdhaW47XG4gICAgICAgIH0pXG4gIC8vIGAucmFkaXVzVmFsdWVBY2Nlc3NvcmAgLSB0aGUgdmFsdWUgd2lsbCBiZSBwYXNzZWQgdG8gdGhlIGAucigpYCBzY2FsZSB0byBkZXRlcm1pbmUgcmFkaXVzIHNpemU7XG4gIC8vICAgYnkgZGVmYXVsdCB0aGlzIG1hcHMgbGluZWFybHkgdG8gWzAsMTAwXVxuICAgIC5yYWRpdXNWYWx1ZUFjY2Vzc29yKChwKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gcC52YWx1ZS5mbHVjdHVhdGlvblBlcmNlbnRhZ2U7XG4gICAgICAgIH0pXG4gICAgLm1heEJ1YmJsZVJlbGF0aXZlU2l6ZSgwLjMpXG4gICAgLngoZDMuc2NhbGVMaW5lYXIoKS5kb21haW4oWy0yNTAwLCAyNTAwXSkpXG4gICAgLnkoZDMuc2NhbGVMaW5lYXIoKS5kb21haW4oWy0xMDAsIDEwMF0pKVxuICAgIC5yKGQzLnNjYWxlTGluZWFyKCkuZG9tYWluKFswLCA0MDAwXSkpXG4gIC8vICMjIyMjIEVsYXN0aWMgU2NhbGluZ1xuXG4gIC8vIGAuZWxhc3RpY1lgIGFuZCBgLmVsYXN0aWNYYCBkZXRlcm1pbmUgd2hldGhlciB0aGUgY2hhcnQgc2hvdWxkIHJlc2NhbGUgZWFjaCBheGlzIHRvIGZpdCB0aGUgZGF0YS5cbiAgICAuZWxhc3RpY1kodHJ1ZSlcbiAgICAuZWxhc3RpY1godHJ1ZSlcbiAgLy8gYC55QXhpc1BhZGRpbmdgIGFuZCBgLnhBeGlzUGFkZGluZ2AgYWRkIHBhZGRpbmcgdG8gZGF0YSBhYm92ZSBhbmQgYmVsb3cgdGhlaXIgbWF4IHZhbHVlcyBpbiB0aGUgc2FtZSB1bml0XG4gIC8vIGRvbWFpbnMgYXMgdGhlIEFjY2Vzc29ycy5cbiAgICAueUF4aXNQYWRkaW5nKDEwMClcbiAgICAueEF4aXNQYWRkaW5nKDUwMClcbiAgLy8gKF9vcHRpb25hbF8pIHJlbmRlciBob3Jpem9udGFsIGdyaWQgbGluZXMsIGBkZWZhdWx0PWZhbHNlYFxuICAgIC5yZW5kZXJIb3Jpem9udGFsR3JpZExpbmVzKHRydWUpXG4gIC8vIChfb3B0aW9uYWxfKSByZW5kZXIgdmVydGljYWwgZ3JpZCBsaW5lcywgYGRlZmF1bHQ9ZmFsc2VgXG4gICAgLnJlbmRlclZlcnRpY2FsR3JpZExpbmVzKHRydWUpXG4gIC8vIChfb3B0aW9uYWxfKSByZW5kZXIgYW4gYXhpcyBsYWJlbCBiZWxvdyB0aGUgeCBheGlzXG4gICAgLnhBeGlzTGFiZWwoJ0NyeXRwbyBHYWluICQnKVxuICAvLyAoX29wdGlvbmFsXykgcmVuZGVyIGEgdmVydGljYWwgYXhpcyBsYWJsZSBsZWZ0IG9mIHRoZSB5IGF4aXNcbiAgICAueUF4aXNMYWJlbCgnQ3J5cHRvIEdhaW4gJScpXG4gIC8vICMjIyMjIExhYmVscyBhbmQgIFRpdGxlc1xuXG4gIC8vIExhYmVscyBhcmUgZGlzcGxheWVkIG9uIHRoZSBjaGFydCBmb3IgZWFjaCBidWJibGUuIFRpdGxlcyBkaXNwbGF5ZWQgb24gbW91c2VvdmVyLlxuICAvLyAoX29wdGlvbmFsXykgd2hldGhlciBjaGFydCBzaG91bGQgcmVuZGVyIGxhYmVscywgYGRlZmF1bHQgPSB0cnVlYFxuICAgIC5yZW5kZXJMYWJlbCh0cnVlKVxuICAgIC5sYWJlbCgocCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHAua2V5O1xuICAgICAgICB9KVxuICAvLyAoX29wdGlvbmFsXykgd2hldGhlciBjaGFydCBzaG91bGQgcmVuZGVyIHRpdGxlcywgYGRlZmF1bHQgPSBmYWxzZWBcbiAgICAucmVuZGVyVGl0bGUodHJ1ZSlcbiAgICAudGl0bGUoKHApID0+IHtcbiAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgICAgcC5rZXksXG4gICAgICAgICAgICAgICAgJ0luZGV4IEdhaW46ICcgKyBudW1iZXJGb3JtYXQocC52YWx1ZS5hYnNHYWluKSxcbiAgICAgICAgICAgICAgICAnSW5kZXggR2FpbiBpbiBQZXJjZW50YWdlOiAnICsgbnVtYmVyRm9ybWF0KHAudmFsdWUucGVyY2VudGFnZUdhaW4pICsgJyUnLFxuICAgICAgICAgICAgICAgICdGbHVjdHVhdGlvbiAvIEluZGV4IFJhdGlvOiAnICsgbnVtYmVyRm9ybWF0KHAudmFsdWUuZmx1Y3R1YXRpb25QZXJjZW50YWdlKSArICclJ1xuICAgICAgICAgICAgXS5qb2luKCdcXG4nKTtcbiAgICAgICAgfSlcbiAgLy8gIyMjIyBDdXN0b21pemUgQXhlc1xuXG4gIC8vIFNldCBhIGN1c3RvbSB0aWNrIGZvcm1hdC4gQm90aCBgLnlBeGlzKClgIGFuZCBgLnhBeGlzKClgIHJldHVybiBhbiBheGlzIG9iamVjdCxcbiAgLy8gc28gYW55IGFkZGl0aW9uYWwgbWV0aG9kIGNoYWluaW5nIGFwcGxpZXMgdG8gdGhlIGF4aXMsIG5vdCB0aGUgY2hhcnQuXG4gICAgLnlBeGlzKClcbi50aWNrRm9ybWF0KCh2KSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gdiArICclJztcbiAgICAgICAgfSk7XG5cbiAgLy8gIyMjIyBQaWUvRG9udXQgQ2hhcnRzXG5cbiAgZ2Fpbk9yTG9zc0NoYXJ0IC8qIGRjLnBpZUNoYXJ0KCcjZ2Fpbi1sb3NzLWNoYXJ0JywgJ2NoYXJ0R3JvdXAnKSAqL1xuICAgIC8vIChfb3B0aW9uYWxfKSBkZWZpbmUgY2hhcnQgd2lkdGgsIGBkZWZhdWx0ID0gMjAwYFxuICAgIC53aWR0aCh3aWR0aClcbiAgICAvLyAob3B0aW9uYWwpIGRlZmluZSBjaGFydCBoZWlnaHQsIGBkZWZhdWx0ID0gMjAwYFxuICAgIC5oZWlnaHQoaGVpZ2h0KVxuICAgIC8vIERlZmluZSBwaWUgcmFkaXVzXG4gICAgLnJhZGl1cyg4MClcbiAgICAvLyBTZXQgZGltZW5zaW9uXG4gICAgLmRpbWVuc2lvbihnYWluT3JMb3NzKVxuICAgIC8vIFNldCBncm91cFxuICAgIC5ncm91cChnYWluT3JMb3NzR3JvdXApXG5cbiAgICAvLyAoX29wdGlvbmFsXykgYnkgZGVmYXVsdCBwaWUgY2hhcnQgd2lsbCB1c2UgYGdyb3VwLmtleWAgYXMgaXRzIGxhYmVsIGJ1dCB5b3UgY2FuIG92ZXJ3cml0ZSBpdCB3aXRoIGEgY2xvc3VyZS5cbiAgICAubGFiZWwoKGQpID0+IHtcbiAgICAgICAgICAgIGlmIChnYWluT3JMb3NzQ2hhcnQuaGFzRmlsdGVyKCkgJiYgIWdhaW5Pckxvc3NDaGFydC5oYXNGaWx0ZXIoZC5rZXkpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGQua2V5ICsgJygwJSknO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGxhYmVsID0gZC5rZXk7XG4gICAgICAgICAgICBpZiAoYWxsLnZhbHVlKCkpIHtcbiAgICAgICAgICAgICAgICBsYWJlbCArPSAnKCcgKyBNYXRoLmZsb29yKGQudmFsdWUgLyBhbGwudmFsdWUoKSAqIDEwMCkgKyAnJSknO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGxhYmVsO1xuICAgICAgICB9KTtcblxuICBkYXlPZldlZWtDaGFydCAvKiBkYy5yb3dDaGFydCgnI2RheS1vZi13ZWVrLWNoYXJ0JywgJ2NoYXJ0R3JvdXAnKSAqL1xuICAgIC53aWR0aCh3aWR0aClcbiAgICAuaGVpZ2h0KGhlaWdodClcbiAgICAubWFyZ2lucyh7XG4gdG9wOiAyMCwgbGVmdDogMTAsIHJpZ2h0OiAxMCwgYm90dG9tOiAyMFxuIH0pXG4gICAgLmdyb3VwKGRheU9mV2Vla0dyb3VwKVxuICAgIC5kaW1lbnNpb24oZGF5T2ZXZWVrKVxuICAvLyBBc3NpZ24gY29sb3JzIHRvIGVhY2ggdmFsdWUgaW4gdGhlIHggc2NhbGUgZG9tYWluXG4gICAgLm9yZGluYWxDb2xvcnMoWycjMzE4MmJkJywgJyM2YmFlZDYnLCAnIzllY2FlMScsICcjYzZkYmVmJywgJyNkYWRhZWInXSlcbiAgICAubGFiZWwoKGQpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBkLmtleS5zcGxpdCgnLicpWzFdO1xuICAgICAgICB9KVxuICAvLyBUaXRsZSBzZXRzIHRoZSByb3cgdGV4dFxuICAgIC50aXRsZSgoZCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGQudmFsdWU7XG4gICAgICAgIH0pXG4gICAgLmVsYXN0aWNYKHRydWUpXG4gICAgLnhBeGlzKClcbi50aWNrcyg0KTtcblxuICAvLyAjIyMjIEJhciBDaGFydFxuXG4gIC8vIENyZWF0ZSBhIGJhciBjaGFydCBhbmQgdXNlIHRoZSBnaXZlbiBjc3Mgc2VsZWN0b3IgYXMgYW5jaG9yLiBZb3UgY2FuIGFsc28gc3BlY2lmeVxuICAvLyBhbiBvcHRpb25hbCBjaGFydCBncm91cCBmb3IgdGhpcyBjaGFydCB0byBiZSBzY29wZWQgd2l0aGluLiBXaGVuIGEgY2hhcnQgYmVsb25nc1xuICAvLyB0byBhIHNwZWNpZmljIGdyb3VwIHRoZW4gYW55IGludGVyYWN0aW9uIHdpdGggc3VjaCBjaGFydCB3aWxsIG9ubHkgdHJpZ2dlciByZWRyYXdcbiAgLy8gb24gb3RoZXIgY2hhcnRzIHdpdGhpbiB0aGUgc2FtZSBjaGFydCBncm91cC5cbiAgLy8gPGJyPkFQSTogW0JhciBDaGFydF0oaHR0cHM6Ly9naXRodWIuY29tL2RjLWpzL2RjLmpzL2Jsb2IvbWFzdGVyL3dlYi9kb2NzL2FwaS1sYXRlc3QubWQjYmFyLWNoYXJ0KVxuICBmbHVjdHVhdGlvbkNoYXJ0IC8qIGRjLmJhckNoYXJ0KCcjdm9sdW1lLW1vbnRoLWNoYXJ0JywgJ2NoYXJ0R3JvdXAnKSAqL1xuICAgIC53aWR0aCh3aWR0aClcbiAgICAuaGVpZ2h0KGhlaWdodClcbiAgICAubWFyZ2lucyh7IFxudG9wOiAxMCwgcmlnaHQ6IDUwLCBib3R0b206IDMwLCBsZWZ0OiA0MCBcbn0pXG4gICAgLmRpbWVuc2lvbihmbHVjdHVhdGlvbilcbiAgICAuZ3JvdXAoZmx1Y3R1YXRpb25Hcm91cClcbiAgICAuZWxhc3RpY1kodHJ1ZSlcbiAgLy8gKF9vcHRpb25hbF8pIHdoZXRoZXIgYmFyIHNob3VsZCBiZSBjZW50ZXIgdG8gaXRzIHggdmFsdWUuIE5vdCBuZWVkZWQgZm9yIG9yZGluYWwgY2hhcnQsIGBkZWZhdWx0PWZhbHNlYFxuICAgIC5jZW50ZXJCYXIodHJ1ZSlcbiAgLy8gKF9vcHRpb25hbF8pIHNldCBnYXAgYmV0d2VlbiBiYXJzIG1hbnVhbGx5IGluIHB4LCBgZGVmYXVsdD0yYFxuICAgIC5nYXAoMSlcbiAgLy8gKF9vcHRpb25hbF8pIHNldCBmaWx0ZXIgYnJ1c2ggcm91bmRpbmdcbiAgICAucm91bmQoZGMucm91bmQuZmxvb3IpXG4gICAgLmFsd2F5c1VzZVJvdW5kaW5nKHRydWUpXG4gICAgLngoZDMuc2NhbGVMaW5lYXIoKS5kb21haW4oWy0yNSwgMjVdKSlcbiAgICAucmVuZGVySG9yaXpvbnRhbEdyaWRMaW5lcyh0cnVlKVxuICAvLyBDdXN0b21pemUgdGhlIGZpbHRlciBkaXNwbGF5ZWQgaW4gdGhlIGNvbnRyb2wgc3BhblxuICAgIC5maWx0ZXJQcmludGVyKChmaWx0ZXJzKSA9PiB7XG4gICAgICAgICAgICB2YXIgZmlsdGVyID0gZmlsdGVyc1swXSwgcyA9ICcnO1xuICAgICAgICAgICAgcyArPSBudW1iZXJGb3JtYXQoZmlsdGVyWzBdKSArICclIC0+ICcgKyBudW1iZXJGb3JtYXQoZmlsdGVyWzFdKSArICclJztcbiAgICAgICAgICAgIHJldHVybiBzO1xuICAgICAgICB9KTtcblxuICAvLyBDdXN0b21pemUgYXhlc1xuICBmbHVjdHVhdGlvbkNoYXJ0LnhBeGlzKCkudGlja0Zvcm1hdChcbiAgICAodikgPT4geyByZXR1cm4gdiArICclJzsgfVxuKTtcbiAgZmx1Y3R1YXRpb25DaGFydC55QXhpcygpLnRpY2tzKDUpO1xuXG4gIC8vICMjIyMgU3RhY2tlZCBBcmVhIENoYXJ0XG5cbiAgLy8gU3BlY2lmeSBhbiBhcmVhIGNoYXJ0IGJ5IHVzaW5nIGEgbGluZSBjaGFydCB3aXRoIGAucmVuZGVyQXJlYSh0cnVlKWAuXG4gIC8vIDxicj5BUEk6IFtTdGFjayBNaXhpbl0oaHR0cHM6Ly9naXRodWIuY29tL2RjLWpzL2RjLmpzL2Jsb2IvbWFzdGVyL3dlYi9kb2NzL2FwaS1sYXRlc3QubWQjc3RhY2stbWl4aW4pLFxuICAvLyBbTGluZSBDaGFydF0oaHR0cHM6Ly9naXRodWIuY29tL2RjLWpzL2RjLmpzL2Jsb2IvbWFzdGVyL3dlYi9kb2NzL2FwaS1sYXRlc3QubWQjbGluZS1jaGFydClcbiAgbW92ZUNoYXJ0IC8qIGRjLmxpbmVDaGFydCgnI21vbnRobHktbW92ZS1jaGFydCcsICdjaGFydEdyb3VwJykgKi9cbiAgICAucmVuZGVyQXJlYSh0cnVlKVxuICAgIC53aWR0aCh3aWR0aClcbiAgICAuaGVpZ2h0KDE1MClcbiAgICAudHJhbnNpdGlvbkR1cmF0aW9uKDEwMDApXG4gICAgLm1hcmdpbnMoe1xuIHRvcDogMzAsIHJpZ2h0OiA1MCwgYm90dG9tOiA1NSwgbGVmdDogNTIgXG59KVxuICAgIC5kaW1lbnNpb24obW92ZU1vbnRocylcbiAgICAubW91c2Vab29tYWJsZSh0cnVlKVxuICAgIC8vIFNwZWNpZnkgYSBcInJhbmdlIGNoYXJ0XCIgdG8gbGluayBpdHMgYnJ1c2ggZXh0ZW50IHdpdGggdGhlIHpvb20gb2YgdGhlIGN1cnJlbnQgXCJmb2N1cyBjaGFydFwiLlxuICAgIC5yYW5nZUNoYXJ0KHZvbHVtZUNoYXJ0KVxuICAgIC54KGQzLnNjYWxlVGltZSgpLmRvbWFpbihbbmV3IERhdGUobWluRGF0ZSksIG5ldyBEYXRlKG1heERhdGUpXSkpXG4gICAgLnJvdW5kKGQzLnRpbWVNb250aC5yb3VuZClcbiAgICAueFVuaXRzKGQzLnRpbWVNb250aHMpXG4gICAgLmVsYXN0aWNZKHRydWUpXG4gICAgLnJlbmRlckhvcml6b250YWxHcmlkTGluZXModHJ1ZSlcbiAgICBcblxuICAgIC8vICMjIyMjIExlZ2VuZFxuXG4gIC8vIFBvc2l0aW9uIHRoZSBsZWdlbmQgcmVsYXRpdmUgdG8gdGhlIGNoYXJ0IG9yaWdpbiBhbmQgc3BlY2lmeSBpdGVtcycgaGVpZ2h0IGFuZCBzZXBhcmF0aW9uLlxuICAgIC5sZWdlbmQoZGMubGVnZW5kKCkueCg4MDApLnkoMTApLml0ZW1IZWlnaHQoMTMpXG4uZ2FwKDUpKVxuICAgIC5icnVzaE9uKGZhbHNlKVxuICAvLyBBZGQgdGhlIGJhc2UgbGF5ZXIgb2YgdGhlIHN0YWNrIHdpdGggZ3JvdXAuIFRoZSBzZWNvbmQgcGFyYW1ldGVyIHNwZWNpZmllcyBhIHNlcmllcyBuYW1lIGZvciB1c2UgaW4gdGhlXG4gIC8vIGxlZ2VuZC5cbiAgLy8gVGhlIGAudmFsdWVBY2Nlc3NvcmAgd2lsbCBiZSB1c2VkIGZvciB0aGUgYmFzZSBsYXllclxuICAgIC5ncm91cChpbmRleEF2Z0J5TW9udGhHcm91cCwgJ01vbnRobHkgSW5kZXggQXZlcmFnZScpXG4gICAgLnZhbHVlQWNjZXNzb3IoKGQpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBkLnZhbHVlLmF2ZztcbiAgICAgICAgfSlcbiAgLy8gU3RhY2sgYWRkaXRpb25hbCBsYXllcnMgd2l0aCBgLnN0YWNrYC4gVGhlIGZpcnN0IHBhcmFtZW50ZXIgaXMgYSBuZXcgZ3JvdXAuXG4gIC8vIFRoZSBzZWNvbmQgcGFyYW1ldGVyIGlzIHRoZSBzZXJpZXMgbmFtZS4gVGhlIHRoaXJkIGlzIGEgdmFsdWUgYWNjZXNzb3IuXG4gICAgLnN0YWNrKG1vbnRobHlNb3ZlR3JvdXAsICdNb250aGx5IEluZGV4IE1vdmUnLCAoZCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGQudmFsdWU7XG4gICAgICAgIH0pXG4gIC8vIFRpdGxlIGNhbiBiZSBjYWxsZWQgYnkgYW55IHN0YWNrIGxheWVyLlxuICAgIC50aXRsZSgoZCkgPT4ge1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gZC52YWx1ZS5hdmcgPyBkLnZhbHVlLmF2ZyA6IGQudmFsdWU7XG4gICAgICAgICAgICBpZiAoaXNOYU4odmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGRhdGVGb3JtYXQoZC5rZXkpICsgJ1xcbicgKyBudW1iZXJGb3JtYXQodmFsdWUpO1xuICAgICAgICB9KTtcblxuICAvLyAjIyMjIFJhbmdlIENoYXJ0XG5cbiAgLy8gU2luY2UgdGhpcyBiYXIgY2hhcnQgaXMgc3BlY2lmaWVkIGFzIFwicmFuZ2UgY2hhcnRcIiBmb3IgdGhlIGFyZWEgY2hhcnQsIGl0cyBicnVzaCBleHRlbnRcbiAgLy8gd2lsbCBhbHdheXMgbWF0Y2ggdGhlIHpvb20gb2YgdGhlIGFyZWEgY2hhcnQuXG4gIHZvbHVtZUNoYXJ0LndpZHRoKHdpZHRoKSAvKiBkYy5iYXJDaGFydCgnI21vbnRobHktdm9sdW1lLWNoYXJ0JywgJ2NoYXJ0R3JvdXAnKTsgKi9cbiAgICAuaGVpZ2h0KDE1MClcbiAgICAubWFyZ2lucyh7IFxudG9wOiAwLCByaWdodDogNTAsIGJvdHRvbTogNTUsIGxlZnQ6IDQwXG4gfSlcbiAgICAuZGltZW5zaW9uKG1vdmVNb250aHMpXG4gICAgLmdyb3VwKHZvbHVtZUJ5TW9udGhHcm91cClcbiAgICAuY2VudGVyQmFyKHRydWUpXG4gICAgLmdhcCgxKVxuICAgIC54KGQzLnNjYWxlVGltZSgpLmRvbWFpbihbbmV3IERhdGUobWluRGF0ZSksIG5ldyBEYXRlKG1heERhdGUpXSkpXG4gICAgLnJvdW5kKGQzLnRpbWVNb250aC5yb3VuZClcbiAgICAuYWx3YXlzVXNlUm91bmRpbmcodHJ1ZSlcbiAgICAueFVuaXRzKGQzLnRpbWVNb250aHMpXG4gICAgLnlBeGlzTGFiZWwoJ0JpbGxpb25zICQnKVxuXG4gIC8vICMjIyMgUmVuZGVyaW5nXG5cbiAgZGMucmVuZGVyQWxsKCk7XG59KTtcbiJdfQ==
